{"metadata":{"usedHelpers":[],"marked":[],"modules":{"imports":[{"source":"meteor/templating","imported":["Template"],"specifiers":[{"kind":"named","imported":"Template","local":"Template"}]},{"source":"./templates.html","imported":[],"specifiers":[]}],"exports":{"exported":[],"specifiers":[]}}},"options":{"filename":"/imports/ui/pages/templates.js","filenameRelative":"/imports/ui/pages/templates.js","env":{},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"polyfill":false}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":false,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"/imports/ui/pages/templates.js.map","sourceFileName":"/imports/ui/pages/templates.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"basename":"templates"},"ignored":false,"code":"var _templating = require('meteor/templating');\n\nrequire('./templates.html');\n\n_templating.Template.duolingo.rendered = function () {\n\n    // 1. Parse & display text of selected module\n    var selectedModule = $('select#contents').val();\n    if (!$.isNumeric(selectedModule)) {\n        $.error(\"Selected module isn't a valid one: \" + selectedModule);\n    }\n    // a) Parse\n    parse(selectedModule);\n\n    var correctEO = \"\";\n    // b) Display\n    setTimeout(function () {\n        display();\n    }, 1000);\n\n    // 2. If module is changed, reparse & display\n    $('select#contents').change(function () {\n        selectedModule = $('select#contents').val();\n        if (!$.isNumeric(selectedModule)) {\n            $.error(\"Selected module isn't a valid one: \" + selectedModule);\n        }\n        parse(selectedModule);\n        setTimeout(function () {\n            display();\n        }, 1000);\n    });\n\n    // 3. Logic - check results, see if input field is correct\n    // a) Click 'check' button\n    $('button#checking').on('click', function () {\n        if (!$('textarea#answer').hasClass('incorrect') && !$('textarea#answer').hasClass('correct')) {\n            logic();\n        }\n    });\n    // b) Press 'enter' key\n    $('textarea#answer').keydown(function (e) {\n        if (e.keyCode == 13) {\n            e.preventDefault();\n            if (!$('textarea#answer').hasClass('incorrect') && !$('textarea#answer').hasClass('correct')) {\n                logic();\n            }\n        }\n    });\n\n    // > Skip button clicked\n    $('button#skip').on('click', function () {\n        display();\n    });\n\n    // > If we're displaying mobile css, change '>' to 'v'\n\n    // Subroutines\n    function parse(module) {\n        hash = new Object();\n        var fileName = 'assets/txt/duo' + module + '.txt';\n        try {\n            $.get(fileName, function (data) {\n                // console.log(data);\n                // Break result into line by line\n                var lines = data.split(\"\\n\");\n                var currentEsperanto = \"\";\n                for (var i = 0; i < lines.length; i++) {\n                    var current = lines[i];\n                    if (matchesEO = current.match(/\\ {4}O:.*$/)) {\n                        // EO\n                        currentEsperanto = matchesEO[0].replace(/\\ {4}O:\\ /, \"\");\n                    } else if (matchesEN = current.match(/\\ {4}E:.*$/)) {\n                        // EN\n                        var english = matchesEN[0].replace(/\\ {4}E:\\ /, \"\");\n                        hash[english] = currentEsperanto;\n                    }\n                }\n            }, 'text');\n        } catch (e) {\n            console.warn(e);\n        }\n    }\n\n    function display() {\n        var length = Object.keys(hash).length;\n        var index = Math.floor(Math.random() * (length - 1) + 0);\n        var keys = Object.keys(hash);\n        var wantedEng = keys[index];\n        correctEO = hash[wantedEng];\n        $('.display-text').html(wantedEng);\n    }\n\n    function logic() {\n        var inputString = $('textarea#answer').val();\n        var sanitisedString = inputString.replace(/[^a-zA-Z0-9_\\-.,?!'\" ĉĝĥĵŝŭĈĜĤĴŜŬ]/g, \"\");\n        var simplifiedEO = correctEO.replace(/[.?!,:\"]/g, \"\").toLowerCase();\n        var simplifiedString = sanitisedString.replace(/[.?!,:\"]/g, \"\").toLowerCase();\n        if (simplifiedEO === simplifiedString) {\n            // console.log(\"correct \" + simplifiedString + \" \" + simplifiedEO);\n            $('textarea#answer').addClass('correct');\n            // display new one\n            setTimeout(function () {\n                display();\n                $('textarea#answer').val('');\n                $('textarea#answer').removeClass('correct');\n            }, 700);\n        } else {\n            // console.log(\"incorrect \" + simplifiedString + \" \" + simplifiedEO);\n            // Change to correct answer\n            $('textarea#answer').addClass('incorrect');\n            $('textarea#answer').val(correctEO);\n\n            // if keypress, then clear straight away\n            $('textarea#answer').keydown(function (e) {\n                if ($('textarea#answer').hasClass('incorrect') && e.keyCode != 13) {\n                    $('textarea#answer').removeClass('incorrect');\n                    $('textarea#answer').val('');\n                }\n            });\n\n            // else wait for timer\n            setTimeout(function () {\n                if ($('textarea#answer').hasClass('incorrect')) {\n                    $('textarea#answer').removeClass('incorrect');\n                    $('textarea#answer').val('');\n                }\n            }, 3000);\n        }\n    }\n};","ast":null,"map":{"version":3,"sources":["/imports/ui/pages/templates.js"],"names":[],"mappings":"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","file":"/imports/ui/pages/templates.js.map","sourcesContent":["import { Template } from 'meteor/templating';\n\nimport './templates.html';\n\nTemplate.duolingo.rendered = function() {\n\n    \n    // 1. Parse & display text of selected module\n    var selectedModule = $('select#contents').val();\n    if (!$.isNumeric(selectedModule)) {\n        $.error(\"Selected module isn't a valid one: \" + selectedModule);\n    }\n    // a) Parse\n    parse(selectedModule);\n\n    var correctEO = \"\";\n    // b) Display\n    setTimeout(function () {\n        display();\n    }, 1000);\n\n\n    // 2. If module is changed, reparse & display\n    $('select#contents').change(function() {\n        selectedModule = $('select#contents').val();\n        if (!$.isNumeric(selectedModule)) {\n            $.error(\"Selected module isn't a valid one: \" + selectedModule);\n        }\n        parse(selectedModule);\n        setTimeout(function () {\n            display();\n        }, 1000);\n    });\n\n    // 3. Logic - check results, see if input field is correct\n    // a) Click 'check' button\n    $('button#checking').on('click', function() {\n        if (!$('textarea#answer').hasClass('incorrect') && !$('textarea#answer').hasClass('correct')) {\n            logic();\n        }\n    });\n    // b) Press 'enter' key\n    $('textarea#answer').keydown(function (e) {\n        if (e.keyCode == 13)  {\n            e.preventDefault();\n            if (!$('textarea#answer').hasClass('incorrect') && !$('textarea#answer').hasClass('correct')) {\n                logic();\n            }\n        }\n    })\n\n    // > Skip button clicked\n    $('button#skip').on('click', function() {\n        display();\n    });\n\n    // > If we're displaying mobile css, change '>' to 'v'\n\n\n    // Subroutines\n    function parse(module) {\n        hash = new Object();\n        var fileName = 'assets/txt/duo' + module + '.txt';\n        try {\n            $.get(fileName, function(data) {\n                // console.log(data);\n                // Break result into line by line\n                var lines = data.split(\"\\n\");\n                var currentEsperanto = \"\";\n                for (var i=0; i<lines.length; i++) {\n                    var current = lines[i];\n                    if (matchesEO = current.match(/\\ {4}O:.*$/)) { // EO\n                        currentEsperanto = matchesEO[0].replace(/\\ {4}O:\\ /, \"\");\n                    } else if (matchesEN = current.match(/\\ {4}E:.*$/)) { // EN\n                        var english = matchesEN[0].replace(/\\ {4}E:\\ /, \"\");\n                        hash[english] = currentEsperanto;\n                    }\n                }\n            }, 'text');\n        } catch (e) {\n            console.warn(e);\n        }\n    }\n\n    function display() {\n        var length = Object.keys(hash).length;\n        var index = Math.floor((Math.random() * (length - 1)) + 0);\n        var keys = Object.keys(hash);\n        var wantedEng = keys[index];\n        correctEO = hash[wantedEng];\n        $('.display-text').html(wantedEng);\n    }\n\n    function logic() {\n        var inputString = $('textarea#answer').val();\n        var sanitisedString = inputString.replace(/[^a-zA-Z0-9_\\-.,?!'\" ĉĝĥĵŝŭĈĜĤĴŜŬ]/g, \"\");\n        var simplifiedEO = correctEO.replace(/[.?!,:\"]/g, \"\").toLowerCase();\n        var simplifiedString = sanitisedString.replace(/[.?!,:\"]/g, \"\").toLowerCase();\n        if (simplifiedEO === simplifiedString) {\n            // console.log(\"correct \" + simplifiedString + \" \" + simplifiedEO);\n            $('textarea#answer').addClass('correct');\n            // display new one\n            setTimeout(function () {\n                display();\n                $('textarea#answer').val('');\n                $('textarea#answer').removeClass('correct');\n            }, 700);\n        } else {\n            // console.log(\"incorrect \" + simplifiedString + \" \" + simplifiedEO);\n            // Change to correct answer\n            $('textarea#answer').addClass('incorrect');\n            $('textarea#answer').val(correctEO);\n\n            // if keypress, then clear straight away\n            $('textarea#answer').keydown(function(e) {\n                if ($('textarea#answer').hasClass('incorrect') && (e.keyCode != 13)) {\n                    $('textarea#answer').removeClass('incorrect');\n                    $('textarea#answer').val('');\n                }\n            });\n\n            // else wait for timer\n            setTimeout(function() {\n                if ($('textarea#answer').hasClass('incorrect')) {\n                    $('textarea#answer').removeClass('incorrect');\n                    $('textarea#answer').val('');\n                }\n            }, 3000);\n        }\n    }\n}"]},"hash":"2f5cbe633d9c9d687d178a550152d5eaa7ff7b82"}
